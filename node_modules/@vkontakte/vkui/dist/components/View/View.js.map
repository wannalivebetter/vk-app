{"version":3,"sources":["../../../src/components/View/View.js"],"names":["baseClassNames","transitionStartEventName","transitionEndEventName","scrollsCache","swipeBackExcludedTags","View","props","e","manual","indexOf","animationName","activePanel","isBack","state","prevPanel","document","dispatchEvent","window","CustomEvent","setState","nextPanel","visiblePanels","animated","undefined","scrolls","scrollTo","onTransition","from","to","propertyName","target","classList","contains","swipingBackFinish","onSwipeBackSuccess","onSwipeBackCancel","scrollTop","body","documentElement","duration","timing","n","Math","sqrt","draw","val","originalEvent","tagName","toLowerCase","IS_PLATFORM_IOS","context","isWebView","startX","innerWidth","browserSwipe","onSwipeBack","swipingBack","history","length","swipebackStartX","startT","swipeBackPrevPanel","swipeBackNextPanel","slice","pageYOffset","swipeBackShift","shiftX","speed","Date","c","container","id","el","refsStore","nextProps","popout","blurActiveElement","modal","firstLayer","panels","find","panel","prevProps","prevState","detail","nextPanelElement","pickPanel","prevPanelElement","waitAnimationFinish","transitionEndHandler","onSwipeBackStart","waitTransitionFinish","swipingBackTransitionEndHandler","elem","eventHandler","transitionEvents","supported","eventName","prefix","removeEventListener","addEventListener","setTimeout","bind","IS_PLATFORM_ANDROID","activeElement","blur","getElementById","console","warn","parentNode","panelId","isPrev","isNext","prevPanelTranslate","nextPanelTranslate","prevPanelShadow","boxShadow","transform","WebkitTransform","title","bg","left","addon","right","opacity","titleTransform","leftTransform","style","header","hasPopout","hasModal","filter","modifiers","onMoveX","onEnd","onScrollTop","panelHeaderClasses","map","headerSwipeStyles","calcHeaderSwipeStyles","icon","calcPanelSwipeStyles","concat","children","Component","PropTypes","object","string","oneOfType","bool","node","func","arrayOf","any"],"mappings":"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","sourcesContent":["\nimport React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport classNames from '../../lib/classNames';\nimport animate from '../../lib/animate';\nimport transitionEvents from '../../lib/transitionEvents';\nimport getClassName from '../../helpers/getClassName';\nimport { IS_PLATFORM_IOS, IS_PLATFORM_ANDROID } from '../../lib/platform';\nimport Touch from '../Touch/Touch';\nimport removeObjectKeys from '../../lib/removeObjectKeys';\nimport { baseClassNames as panelHeaderClasses } from '../PanelHeader/PanelHeader';\n\nconst baseClassNames = getClassName('View');\n\nexport const transitionStartEventName = 'VKUI:View:transition-start';\nexport const transitionEndEventName = 'VKUI:View:transition-end';\n\nlet scrollsCache = {};\n\nconst swipeBackExcludedTags = ['input', 'textarea'];\n\nexport default class View extends Component {\n  constructor (props) {\n    super(props);\n    this.state = {\n      scrolls: scrollsCache[props.id] || {},\n\n      visiblePanels: [props.activePanel],\n      activePanel: props.activePanel,\n      isBack: undefined,\n      prevPanel: null,\n      nextPanel: null,\n\n      swipingBack: false,\n      swipebackStartX: 0,\n      swipeBackShift: 0,\n      swipeBackNextPanel: null,\n      swipeBackPrevPanel: null,\n      swipingBackFinish: null,\n\n      browserSwipe: false\n    };\n  }\n\n  static propTypes = {\n    style: PropTypes.object,\n    activePanel: PropTypes.string,\n    header: PropTypes.oneOfType([PropTypes.object, PropTypes.bool]),\n    children: PropTypes.node,\n    popout: PropTypes.node,\n    modal: PropTypes.node,\n    onTransition: PropTypes.func,\n    /**\n     * @ignore\n     */\n    onSwipeBack: PropTypes.func,\n    /**\n     * @ignore\n     */\n    onSwipeBackStart: PropTypes.func,\n    /**\n     * @ignore\n     */\n    history: PropTypes.arrayOf(PropTypes.string),\n    id: PropTypes.string\n  };\n\n  static defaultProps = {\n    style: {},\n    children: null,\n    popout: null,\n    header: true,\n    history: []\n  };\n\n  static contextTypes = {\n    isWebView: PropTypes.bool,\n    window: PropTypes.any,\n    document: PropTypes.any\n  };\n\n  get document () {\n    return this.context.document || document;\n  }\n\n  get window () {\n    return this.context.window || window;\n  }\n\n  get panels () {\n    return [].concat(this.props.children);\n  }\n\n  refsStore = {};\n\n  componentWillReceiveProps (nextProps) {\n    nextProps.popout && !this.props.popout && this.blurActiveElement();\n    nextProps.modal && !this.props.modal && this.blurActiveElement();\n\n    // Нужен переход\n    if (this.props.activePanel !== nextProps.activePanel && !this.state.swipingBack && !this.state.browserSwipe) {\n      const firstLayer = this.panels.find(\n        panel => panel.props.id === this.props.activePanel || panel.props.id === nextProps.activePanel\n      );\n\n      const isBack = firstLayer && firstLayer.props.id === nextProps.activePanel;\n\n      this.blurActiveElement();\n\n      this.setState({\n        visiblePanels: [this.props.activePanel, nextProps.activePanel],\n        prevPanel: this.props.activePanel,\n        nextPanel: nextProps.activePanel,\n        activePanel: null,\n        animated: true,\n        scrolls: {\n          ...this.state.scrolls,\n          [this.props.activePanel]: this.window.pageYOffset\n        },\n        isBack\n      });\n    }\n\n    // Закончилась анимация свайпа назад\n    if (this.props.activePanel !== nextProps.activePanel && this.state.swipingBack) {\n      const nextPanel = nextProps.activePanel;\n      const prevPanel = this.props.activePanel;\n      this.setState({\n        swipeBackPrevPanel: null,\n        swipeBackNextPanel: null,\n        swipingBack: false,\n        swipingBackFinish: null,\n        swipebackStartX: 0,\n        swipeBackShift: 0,\n        activePanel: nextPanel,\n        visiblePanels: [nextPanel],\n        scrolls: removeObjectKeys(this.state.scrolls, [this.state.swipeBackPrevPanel])\n      }, () => {\n        this.document.dispatchEvent(new this.window.CustomEvent(transitionEndEventName));\n        window.scrollTo(0, this.state.scrolls[this.state.activePanel]);\n        this.props.onTransition && this.props.onTransition({ isBack: true, from: prevPanel, to: nextPanel });\n      });\n    }\n  }\n\n  componentWillUnmount () {\n    if (this.props.id) {\n      scrollsCache[this.props.id] = this.state.scrolls;\n    }\n  }\n\n  componentDidUpdate (prevProps, prevState) {\n    const scrolls = this.state.scrolls;\n\n    // Начался переход\n    if (!prevState.animated && this.state.animated) {\n      this.document.dispatchEvent(new this.window.CustomEvent(transitionStartEventName, { detail: { scrolls } }));\n      const nextPanelElement = this.pickPanel(this.state.nextPanel);\n      const prevPanelElement = this.pickPanel(this.state.prevPanel);\n\n      prevPanelElement.scrollTop = scrolls[this.state.prevPanel];\n      if (this.state.isBack) {\n        nextPanelElement.scrollTop = scrolls[this.state.nextPanel];\n      }\n      this.waitAnimationFinish(this.pickPanel(this.state.isBack ? this.state.prevPanel : this.state.nextPanel), this.transitionEndHandler);\n    }\n\n    // Начался свайп назад\n    if (!prevState.swipingBack && this.state.swipingBack) {\n      this.document.dispatchEvent(new this.window.CustomEvent(transitionStartEventName, { detail: { scrolls } }));\n      this.props.onSwipeBackStart && this.props.onSwipeBackStart();\n      const nextPanelElement = this.pickPanel(this.state.swipeBackNextPanel);\n      const prevPanelElement = this.pickPanel(this.state.swipeBackPrevPanel);\n\n      nextPanelElement.scrollTop = scrolls[this.state.swipeBackNextPanel];\n      prevPanelElement.scrollTop = scrolls[this.state.swipeBackPrevPanel];\n    }\n\n    // Началась анимация завершения свайпа назад.\n    if (prevState.swipingBackFinish === null && this.state.swipingBackFinish !== null) {\n      this.waitTransitionFinish(this.pickPanel(this.state.swipeBackNextPanel), this.swipingBackTransitionEndHandler);\n    }\n\n    // Если свайп назад отменился (когда пользователь недостаточно сильно свайпнул)\n    if (prevState.swipingBackFinish === false && this.state.swipingBackFinish === null) {\n      this.window.scrollTo(0, scrolls[this.state.activePanel]);\n    }\n\n    // Закончился Safari свайп\n    if (prevProps.activePanel !== this.props.activePanel && this.state.browserSwipe) {\n      this.setState({\n        browserSwipe: false,\n        nextPanel: null,\n        prevPanel: null,\n        animated: false,\n        visiblePanels: [this.props.activePanel],\n        activePanel: this.props.activePanel\n      });\n    }\n  }\n\n  waitTransitionFinish (elem, eventHandler) {\n    if (transitionEvents.supported) {\n      const eventName = transitionEvents.prefix ? transitionEvents.prefix + 'TransitionEnd' : 'transitionend';\n\n      elem.removeEventListener(eventName, eventHandler);\n      elem.addEventListener(eventName, eventHandler);\n    } else {\n      setTimeout(eventHandler.bind(this), IS_PLATFORM_ANDROID ? 300 : 600);\n    }\n  }\n\n  waitAnimationFinish (elem, eventHandler) {\n    if (transitionEvents.supported) {\n      const eventName = transitionEvents.prefix ? transitionEvents.prefix + 'AnimationEnd' : 'animationend';\n\n      elem.removeEventListener(eventName, eventHandler);\n      elem.addEventListener(eventName, eventHandler);\n    } else {\n      setTimeout(eventHandler.bind(this), IS_PLATFORM_ANDROID ? 300 : 600);\n    }\n  }\n\n  blurActiveElement () {\n    if (typeof this.window !== 'undefined' && this.document.activeElement) {\n      this.document.activeElement.blur();\n    }\n  }\n\n  pickPanel (id) {\n    const elem = this.document.getElementById(id);\n\n    if (!elem) {\n      console.warn(`Element #${id} not found`);\n    }\n\n    return elem && elem.parentNode.parentNode;\n  }\n\n  transitionEndHandler = (e = { manual: true }) => {\n    if ([\n      'animation-ios-next-forward',\n      'animation-ios-prev-back',\n      'animation-android-next-forward',\n      'animation-android-prev-back'\n    ].indexOf(e.animationName) > -1 || e.manual) {\n      const activePanel = this.props.activePanel;\n      const isBack = this.state.isBack;\n      const prevPanel = this.state.prevPanel;\n      this.document.dispatchEvent(new this.window.CustomEvent(transitionEndEventName));\n      this.setState({\n        prevPanel: null,\n        nextPanel: null,\n        visiblePanels: [activePanel],\n        activePanel: activePanel,\n        animated: false,\n        isBack: undefined,\n        scrolls: isBack ? removeObjectKeys(this.state.scrolls, [prevPanel]) : this.state.scrolls\n      }, function () {\n        isBack && this.window.scrollTo(0, this.state.scrolls[activePanel]);\n        this.props.onTransition && this.props.onTransition({ isBack, from: prevPanel, to: activePanel });\n      });\n    }\n  };\n\n  swipingBackTransitionEndHandler = (e) => {\n    // indexOf because of vendor prefixes in old browsers\n    if (e.propertyName.indexOf('transform') >= 0 && e.target.classList.contains('View__panel--swipe-back-next')) {\n      this.state.swipingBackFinish ? this.onSwipeBackSuccess() : this.onSwipeBackCancel();\n    }\n  };\n\n  onSwipeBackSuccess () {\n    this.props.onSwipeBack && this.props.onSwipeBack();\n  }\n\n  onSwipeBackCancel () {\n    this.setState({\n      swipeBackPrevPanel: null,\n      swipeBackNextPanel: null,\n      swipingBack: false,\n      swipingBackFinish: null,\n      swipebackStartX: 0,\n      swipeBackShift: 0\n    }, () => {\n      this.document.dispatchEvent(new this.window.CustomEvent(transitionEndEventName));\n    });\n  }\n\n  onScrollTop = () => {\n    const { activePanel } = this.state;\n\n    if (activePanel) {\n      const scrollTop = this.document.body.scrollTop || this.document.documentElement.scrollTop;\n\n      if (scrollTop) {\n        animate({\n          duration: 200,\n          timing: n => Math.sqrt(n),\n          draw: (val) => {\n            this.window.scrollTo(0, scrollTop - val * scrollTop);\n          }\n        });\n      }\n    }\n  };\n\n  onMoveX = (e) => {\n    if (swipeBackExcludedTags.indexOf(e.originalEvent.target.tagName.toLowerCase()) > -1) {\n      return;\n    }\n\n    if (IS_PLATFORM_IOS && !this.context.isWebView && (e.startX <= 70 || e.startX >= this.window.innerWidth - 70) && !this.state.browserSwipe) {\n      this.setState({ browserSwipe: true });\n    }\n\n    if (IS_PLATFORM_IOS && this.context.isWebView && this.props.onSwipeBack) {\n      if (this.state.animated && e.startX <= 70) {\n        return;\n      }\n\n      if (e.startX <= 70 && !this.state.swipingBack && this.props.history.length > 1) {\n        this.setState({\n          swipingBack: true,\n          swipebackStartX: e.startX,\n          startT: e.startT,\n          swipeBackPrevPanel: this.state.activePanel,\n          swipeBackNextPanel: this.props.history.slice(-2)[0],\n          scrolls: {\n            ...this.state.scrolls,\n            [this.state.activePanel]: this.window.pageYOffset\n          }\n        });\n      }\n      if (this.state.swipingBack) {\n        let swipeBackShift;\n        if (e.shiftX < 0) {\n          swipeBackShift = 0;\n        } else if (e.shiftX > this.window.innerWidth - this.state.swipebackStartX) {\n          swipeBackShift = this.window.innerWidth;\n        } else {\n          swipeBackShift = e.shiftX;\n        }\n        this.setState({ swipeBackShift });\n      }\n    }\n  };\n\n  onEnd = () => {\n    if (this.state.swipingBack) {\n      const speed = this.state.swipeBackShift / (new Date() - this.state.startT) * 1000;\n      if (this.state.swipeBackShift === 0) {\n        this.onSwipeBackCancel();\n      } else if (this.state.swipeBackShift >= this.window.innerWidth) {\n        this.onSwipeBackSuccess();\n      } else {\n        this.setState({ swipingBackFinish: speed > 250 || this.state.swipebackStartX + this.state.swipeBackShift > this.window.innerWidth / 2 });\n      }\n    }\n  };\n\n  getRef = (c) => {\n    if (c && c.container && c.id) {\n      let el = c;\n\n      while (el.container) {\n        el = el.container;\n      }\n\n      this.refsStore[c.id] = el;\n    }\n  };\n\n  calcPanelSwipeStyles (panelId) {\n    const isPrev = panelId === this.state.swipeBackPrevPanel;\n    const isNext = panelId === this.state.swipeBackNextPanel;\n\n    if (!isPrev && !isNext || this.state.swipingBackFinish !== null) {\n      return {};\n    }\n\n    let prevPanelTranslate = `${this.state.swipeBackShift}px`;\n    let nextPanelTranslate = `${-50 + (this.state.swipeBackShift * 100 / this.window.innerWidth) / 2}%`;\n    let prevPanelShadow = 0.3 * (this.window.innerWidth - this.state.swipeBackShift) / this.window.innerWidth;\n\n    if (this.state.swipingBackFinish !== null) {\n      return isPrev ? { boxShadow: `-2px 0 12px rgba(0, 0, 0, ${prevPanelShadow})` } : {};\n    }\n\n    if (isNext) {\n      return {\n        transform: `translate3d(${nextPanelTranslate}, 0, 0)`,\n        WebkitTransform: `translate3d(${nextPanelTranslate}, 0, 0)`\n      };\n    }\n    if (isPrev) {\n      return {\n        transform: `translate3d(${prevPanelTranslate}, 0, 0)`,\n        WebkitTransform: `translate3d(${prevPanelTranslate}, 0, 0)`,\n        boxShadow: `-2px 0 12px rgba(0, 0, 0, ${prevPanelShadow})`\n      };\n    }\n\n    return {};\n  }\n\n  calcHeaderSwipeStyles (panelId) {\n    const isPrev = panelId === this.state.swipeBackPrevPanel;\n    const isNext = panelId === this.state.swipeBackNextPanel;\n\n    if (!isPrev && !isNext || this.state.swipingBackFinish !== null) {\n      return {\n        title: {},\n        bg: {},\n        left: {},\n        addon: {},\n        right: {}\n      };\n    }\n\n    let opacity = this.state.swipeBackShift / this.window.innerWidth;\n    let titleTransform = this.state.swipeBackShift / this.window.innerWidth * 30;\n    let leftTransform = this.state.swipeBackShift / this.window.innerWidth * 30;\n\n    if (isNext) {\n      return {\n        title: {\n          transform: `translate3d(${-30 + titleTransform}vw, 0, 0)`,\n          WebkitTransform: `translate3d(${-30 + titleTransform}vw, 0, 0)`,\n          opacity\n        },\n        left: { opacity },\n        addon: {\n          opacity: 1,\n          transform: `translate3d(${-30 + leftTransform}vw, 0, 0)`,\n          WebkitTransform: `translate3d(${-30 + leftTransform}vw, 0, 0)`\n        },\n        right: { opacity }\n      };\n    }\n    if (isPrev) {\n      return {\n        title: {\n          transform: `translate3d(${titleTransform}vw, 0, 0)`,\n          WebkitTransform: `translate3d(${titleTransform}vw, 0, 0)`,\n          opacity: 1 - opacity\n        },\n        bg: { opacity: 1 - opacity },\n        left: { opacity: 1 - opacity },\n        addon: {\n          transform: `translate3d(${leftTransform}vw, 0, 0)`,\n          WebkitTransform: `translate3d(${leftTransform}vw, 0, 0)`,\n          opacity: 1 - opacity\n        }\n      };\n    }\n  }\n\n  render () {\n    const { style, popout, modal, header } = this.props;\n    const { prevPanel, nextPanel, activePanel, swipeBackPrevPanel, swipeBackNextPanel, swipingBackFinish } = this.state;\n\n    const hasPopout = !!popout;\n    const hasModal = !!modal;\n\n    const panels = this.panels.filter(panel => {\n      const panelId = panel.props.id;\n\n      return this.state.visiblePanels.indexOf(panelId) > -1 ||\n        panelId === swipeBackPrevPanel ||\n        panelId === swipeBackNextPanel;\n    });\n\n    const modifiers = {\n      'View--header': header,\n      'View--animated': this.state.animated,\n      'View--swiping-back': this.state.swipingBack\n    };\n\n    return (\n      <Touch\n        component=\"section\"\n        className={classNames(baseClassNames, modifiers)}\n        style={style}\n        onMoveX={this.onMoveX}\n        onEnd={this.onEnd}\n      >\n        {header && (\n          <div className=\"View__header\">\n            { IS_PLATFORM_IOS && <div className=\"View__header-scrolltop\" onClick={this.onScrollTop} /> }\n            <div className={classNames(panelHeaderClasses)}>\n              {panels.map(panel => {\n                const panelId = panel.props.id;\n                const headerSwipeStyles = this.calcHeaderSwipeStyles(panelId);\n\n                return (\n                  <div\n                    className={classNames('PanelHeader__in', {\n                      'PanelHeader__in--active': panelId === activePanel,\n                      'PanelHeader__in--prev': panelId === prevPanel,\n                      'PanelHeader__in--next': panelId === nextPanel,\n                      'PanelHeader__in--swipe-back-prev': panelId === swipeBackPrevPanel,\n                      'PanelHeader__in--swipe-back-next': panelId === swipeBackNextPanel,\n                      'PanelHeader__in--swipe-back-success': swipingBackFinish === true,\n                      'PanelHeader__in--swipe-back-failed': swipingBackFinish === false\n                    })}\n                    key={panelId}\n                    id={`panel-header-${panelId}`}\n                  >\n                    <div\n                      className=\"PanelHeader__bg\"\n                      key={panelId}\n                      id={`header-bg-${panelId}`}\n                      style={headerSwipeStyles.bg}\n                    />\n                    <div className=\"PanelHeader__container\">\n                      <div className=\"PanelHeader__left\">\n                        <div\n                          className=\"PanelHeader__left-in\"\n                          id={`header-left-${panelId}`}\n                          style={headerSwipeStyles.left}\n                        />\n                        {IS_PLATFORM_IOS &&\n                        <div\n                          className=\"PanelHeader__addon\"\n                          id={`header-addon-${panelId}`}\n                          style={headerSwipeStyles.icon}\n                        />\n                        }\n                      </div>\n                      <div\n                        className=\"PanelHeader__content\"\n                        style={headerSwipeStyles.title}\n                        id={`header-title-${panelId}`}\n                      />\n                      <div\n                        className=\"PanelHeader__right\"\n                        id={`header-right-${panelId}`}\n                        style={headerSwipeStyles.right}\n                      />\n                    </div>\n                  </div>\n                );\n              })}\n            </div>\n          </div>\n        )}\n        <div className=\"View__panels\">\n          {panels.map(panel => {\n            const panelId = panel.props.id;\n\n            return (\n              <div\n                className={classNames('View__panel', {\n                  'View__panel--active': panelId === activePanel,\n                  'View__panel--prev': panelId === prevPanel,\n                  'View__panel--next': panelId === nextPanel,\n                  'View__panel--swipe-back-prev': panelId === swipeBackPrevPanel,\n                  'View__panel--swipe-back-next': panelId === swipeBackNextPanel,\n                  'View__panel--swipe-back-success': swipingBackFinish === true,\n                  'View__panel--swipe-back-failed': swipingBackFinish === false\n                })}\n                style={this.calcPanelSwipeStyles(panelId)}\n                key={panelId}\n              >\n                <div className=\"View__panel-in\">\n                  {panel}\n                </div>\n              </div>\n            );\n          })}\n        </div>\n        {hasPopout && <div className=\"View__popout\">{popout}</div>}\n        {hasModal && <div className=\"View__modal\">{modal}</div>}\n      </Touch>\n    );\n  }\n}\n"],"file":"View.js"}