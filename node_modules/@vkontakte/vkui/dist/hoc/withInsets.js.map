{"version":3,"sources":["../../src/hoc/withInsets.js"],"names":["initialState","bottom","top","left","right","resolveInsets","e","detail","type","data","insets","vkuiConnect","subscribe","withInsets","Component","setState","connectListener","unsubscribe","props","state","React"],"mappings":";;;;;;;AAAA;;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAEA,IAAIA,YAAY,GAAG;AACjBC,EAAAA,MAAM,EAAE,CADS;AAEjBC,EAAAA,GAAG,EAAE,CAFY;AAGjBC,EAAAA,IAAI,EAAE,CAHW;AAIjBC,EAAAA,KAAK,EAAE;AAJU,CAAnB;;AAOA,SAASC,aAAT,CAAwBC,CAAxB,EAA2B;AAAA,kBACFA,CAAC,CAACC,MADA;AAAA,MACjBC,IADiB,aACjBA,IADiB;AAAA,MACXC,IADW,aACXA,IADW;;AAEzB,UAAQD,IAAR;AACE,SAAK,sBAAL;AACA,SAAK,sBAAL;AAA6B;AAA7B,UACUE,MADV,GACqBD,IADrB,CACUC,MADV;;AAEE,UAAIA,MAAJ,EAAY;AACV,iCAAYA,MAAZ;AAAoBT,UAAAA,MAAM,EAAES,MAAM,CAACT,MAAP,GAAgB,GAAhB,GAAsB,CAAtB,GAA0BS,MAAM,CAACT;AAA7D,WADU,CAC6D;AACxE;;AANL;AAQD;;AAEDU,qBAAYC,SAAZ,CAAsB,UAACN,CAAD,EAAO;AAC3B,MAAMI,MAAM,GAAGL,aAAa,CAACC,CAAD,CAA5B;;AACA,MAAII,MAAJ,EAAY;AACVV,IAAAA,YAAY,GAAGU,MAAf;AACD;AACF,CALD;;AAOe,SAASG,UAAT,CAAqBC,SAArB,EAAgC;AAAA;;AAC7C;AAAA;AAAA;AAAA;;AAAA;AAAA;;AAAA;;AAAA;;AAAA;AAAA;AAAA;;AAAA;;AAAA,sFACUd,YADV;;AAAA,gGAWoB,UAACM,CAAD,EAAO;AACvB,YAAMI,MAAM,GAAGL,aAAa,CAACC,CAAD,CAA5B;;AACA,YAAII,MAAJ,EAAY;AACV,gBAAKK,QAAL,CAAcL,MAAd;AACD;AACF,OAhBH;;AAAA;AAAA;;AAAA;AAAA;AAAA,0CAGuB;AACnBC,6BAAYC,SAAZ,CAAsB,KAAKI,eAA3B;AACD;AALH;AAAA;AAAA,6CAO0B;AACtBL,6BAAYM,WAAZ,CAAwB,KAAKD,eAA7B;AACD;AATH;AAAA;AAAA,+BAkBY;AACR,eACE,6BAAC,SAAD,eAAe,KAAKE,KAApB;AAA2B,UAAA,MAAM,EAAE,KAAKC;AAAxC,WADF;AAGD;AAtBH;;AAAA;AAAA,IAAgCC,eAAMN,SAAtC;AAwBD","sourcesContent":["import React from 'react';\nimport vkuiConnect from '@vkontakte/vkui-connect';\n\nlet initialState = {\n  bottom: 0,\n  top: 0,\n  left: 0,\n  right: 0\n};\n\nfunction resolveInsets (e) {\n  const { type, data } = e.detail;\n  switch (type) {\n    case 'VKWebAppUpdateConfig':\n    case 'VKWebAppUpdateInsets': // Устаревшее событие vkui-connect\n      const { insets } = data;\n      if (insets) {\n        return { ...insets, bottom: insets.bottom > 100 ? 0 : insets.bottom }; // если больше 100 – значит открылась клава и она сама работает как инсет, то есть наш нужно занулить\n      }\n  }\n}\n\nvkuiConnect.subscribe((e) => {\n  const insets = resolveInsets(e);\n  if (insets) {\n    initialState = insets;\n  }\n});\n\nexport default function withInsets (Component) {\n  return class WithInsets extends React.Component {\n    state = initialState;\n\n    componentDidMount () {\n      vkuiConnect.subscribe(this.connectListener);\n    }\n\n    componentWillUnmount () {\n      vkuiConnect.unsubscribe(this.connectListener);\n    }\n\n    connectListener = (e) => {\n      const insets = resolveInsets(e);\n      if (insets) {\n        this.setState(insets);\n      }\n    };\n\n    render () {\n      return (\n        <Component {...this.props} insets={this.state} />\n      );\n    }\n  };\n}\n"],"file":"withInsets.js"}